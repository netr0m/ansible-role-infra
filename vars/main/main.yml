---
### Docker ###
# Shared labels for the Docker volumes
infra_docker_volume_shared_labels:
  netr0m.ansible-role: infra

# Environment variables for the Unifi container
infra_unifi_env_vars:
  PUID: "{{ infra_user_uid | string }}"
  PGID: "{{ infra_group_gid | string }}"
  TZ: "{{ infra_tz | default('Etc/UTC') | string }}"

# unifi container ports
infra_unifi_container_ports:
  admin: 8443
  device_comms: 8080
  guest_portal_https: 8843
  guest_portal_http: 8880
  throughput: 6789
  stun: 3478
  discovery: 10001
  l2_discovery: 1900
  syslog: 5514

# Environment variables for the Pihole container
infra_pihole_env_vars:
  PUID: "{{ infra_user_uid | string }}"
  PGID: "{{ infra_group_gid | string }}"
  TZ: "{{ infra_tz | default('Etc/UTC') | string }}"
  WEBPASSWORD: "{{ infra_pihole_password | default(omit) }}"
  VIRTUAL_HOST: "{{ infra_pihole_container_hostname }}.{{ infra_domain }}"
  DNSMASQ_LISTENING: "{{ infra_pihole_dnsmasq_listening }}"

# DNS environment variables placeholder for the Pihole container
infra_pihole_env_vars_dns: {}

# Environment variables for the unbound container
infra_unbound_env_vars:
  PUID: "{{ infra_user_uid | string }}"
  PGID: "{{ infra_group_gid | string }}"
  TZ: "{{ infra_tz | default('Etc/UTC') | string }}"

# Filename of the unbound config
infra_unbound_config_filename: unbound.conf

# Directory containing additional unbound configs on the host
infra_unbound_config_d_dir_path: "{{ infra_unbound_directories.cfg.path }}/unbound.conf.d"

# Filepath of the unbound config on the host
infra_unbound_config_filepath: "{{ infra_unbound_directories.cfg.path }}/{{ infra_unbound_config_filename }}"

# Environment variables for the Vaultwarden container
infra_vaultwarden_env_vars:
  WEBSOCKET_ENABLED: 'true'
  DOMAIN: "https://{{ infra_vaultwarden_container_hostname }}.{{ infra_domain }}"

# Shared environment variables for the Authentik containers
infra_authentik_env_vars_shared:
  PUID: "{{ infra_user_uid | string }}"
  PGID: "{{ infra_group_gid | string }}"

# Environment variables for the Authentik DB container
infra_authentik_db_env_vars:
  POSTGRES_DB: "{{ infra_authentik_db_name | string }}"
  POSTGRES_USER: "{{ infra_authentik_db_user | string }}"
  POSTGRES_PASSWORD: "{{ infra_authentik_db_password | string }}"

# Environment variables for the Authentik server
infra_authentik_server_env_vars:
  AUTHENTIK_SECRET_KEY: "{{ infra_authentik_secret_key | string }}"
  AUTHENTIK_REDIS__HOST: "{{ infra_authentik_redis_container_hostname | string }}"
  AUTHENTIK_POSTGRESQL__HOST: "{{ infra_authentik_db_container_hostname | string }}"
  AUTHENTIK_POSTGRESQL__NAME: "{{ infra_authentik_db_name | string }}"
  AUTHENTIK_POSTGRESQL__USER: "{{ infra_authentik_db_user | string }}"
  AUTHENTIK_POSTGRESQL__PASSWORD: "{{ infra_authentik_db_password | string }}"

# Shared environment variables for the Graylog containers
infra_graylog_env_vars_shared:
  PUID: "{{ infra_user_uid | string }}"
  PGID: "{{ infra_group_gid | string }}"

# Environment variables for the Graylog server
infra_graylog_server_env_vars:
  GRAYLOG_NODE_ID_FILE: "/usr/share/graylog/data/config/node-id"
  GRAYLOG_PASSWORD_SECRET: "{{ infra_graylog_password_secret | string }}"
  GRAYLOG_ROOT_PASSWORD_SHA2: "{{ infra_graylog_password_sha2 | string }}"
  GRAYLOG_HTTP_BIND_ADDRESS: "0.0.0.0:{{ infra_graylog_server_container_ports.http | default('9000') }}"
  GRAYLOG_HTTP_EXTERNAL_URI: "https://{{ infra_graylog_container_hostname }}.{{ infra_domain }}/"
  GRAYLOG_HTTP_PUBLISH_URI: "https://{{ infra_graylog_container_hostname }}.{{ infra_domain }}/"
  GRAYLOG_ELASTICSEARCH_HOSTS: "http://{{ infra_graylog_opensearch_container_hostname }}:9200"
  GRAYLOG_MONGODB_URI: "mongodb://{{ infra_graylog_db_container_hostname }}:27017/graylog"

# Environment variables for the Graylog DB container
infra_graylog_db_env_vars: {}

# Environment variables for the Graylog Opensearch container
infra_graylog_opensearch_env_vars:
  OPENSEARCH_JAVA_OPTS: '-Xms1g -Xmx2g'
  bootstrap.memory_lock: 'true'
  discovery.type: single-node
  action.auto_create_index: 'false'
  plugins.security.ssl.http.enabled: 'false'
  plugins.security.disabled: 'true'

# Path to the 'node-id' file for the graylog server node
infra_graylog_node_id_path: "{{ infra_graylog_directories.data.path }}/server/node-id"
# File ownership for the graylog server files
infra_graylog_server_container_permissions:
  owner: 1100
  group: 1100
# File ownership for the graylog opensearch files
infra_graylog_opensearch_container_permissions:
  owner: 1000
  group: 1000

# Environment variables for the uptime-kuma container
infra_uptimekuma_env_vars:
  PUID: "{{ infra_user_uid | string }}"
  PGID: "{{ infra_group_gid | string }}"

# Additional middlewares to include in the traefik config
svc_traefik_extra_middlewares_infra: {}

# Additional entrypoints to include in the traefik config
svc_traefik_extra_entrypoints:
  - name: dns
    port: 53
  - name: dnsUdp
    port: 53/udp
  - name: dnsTls
    port: 853
...
