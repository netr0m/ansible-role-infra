---
### Docker ###
# Shared labels for the Docker volumes
infra_docker_volume_shared_labels:
  netr0m.ansible-role: infra

# Additional middlewares to include in the traefik config
svc_traefik_extra_middlewares_infra:
  infra-default-mwr:
    chain:
      middlewares:
        - lan-mwr
        - rate-limit-mwr
        # - sec-headers-mwr
  authentik-auth-mwr:
    forwardAuth:
      address: https://{{ infra_authentik_fqdn }}/outpost.goauthentik.io/auth/traefik
      trustForwardHeader: true
      authResponseHeaders:
        - X-authentik-username
        - X-authentik-groups
        - X-authentik-entitlements
        - X-authentik-email
        - X-authentik-name
        - X-authentik-uid
        - X-authentik-jwt
        - X-authentik-meta-jwks
        - X-authentik-meta-outpost
        - X-authentik-meta-provider
        - X-authentik-meta-app
        - X-authentik-meta-version

# Additional entrypoints to include in the traefik config
svc_traefik_extra_entrypoints:
  - name: dns
    port: 53
  - name: dnsUdp
    port: 53/udp
  - name: dnsTls
    port: 853
...
